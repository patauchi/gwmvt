## C++ optimization flags for high performance
CXX_STD = CXX17

## Additional flags for Armadillo
PKG_CXXFLAGS = -DARMA_NO_DEBUG -DARMA_DONT_USE_WRAPPER -DARMA_USE_LAPACK -DARMA_USE_BLAS
PKG_CXXFLAGS += -DARMA_DONT_PRINT_FAST_MATH_WARNING

## Include paths
PKG_CPPFLAGS = -I. -I./core -I./methods -I./base

## macOS-specific configuration for Intel Mac with Homebrew gcc 14.2.0
ifeq ($(shell uname),Darwin)
    ## Use clang compilers
    CXX = clang++
    CXX11 = clang++
    CXX14 = clang++
    CXX17 = clang++
    CC = clang

    ## Set gfortran library paths explicitly
    GFORTRAN_BASE = /usr/local/Cellar/gcc/14.2.0_1
    GFORTRAN_LIB = $(GFORTRAN_BASE)/lib/gcc/current

    ## Link libraries
    PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) -L$(GFORTRAN_LIB) -lgfortran -lquadmath
    ## Also add the main lib directory
    PKG_LIBS += -L$(GFORTRAN_BASE)/lib

    ## Optional: Add OpenMP if needed (commented for now)
    # PKG_CXXFLAGS += -Xclang -fopenmp
    # PKG_LIBS += -lomp

    ## Info message
    $(info Using gfortran from: $(GFORTRAN_LIB))
else
    ## Linux/Unix
    PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)
endif
