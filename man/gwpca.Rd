% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gwpca.R
\name{gwpca}
\alias{gwpca}
\title{Geographically Weighted Principal Component Analysis}
\usage{
gwpca(
  data,
  coords,
  bandwidth,
  method = c("adaptive_huber", "adaptive_mcd", "spatial_trim", "standard"),
  use_correlation = FALSE,
  k = NULL,
  detect_outliers = TRUE,
  outlier_threshold = 2.5,
  trim_prop = 0.1,
  h_fraction = 0.75,
  lof_k = 10,
  bacon_alpha = 0.05,
  depth_type = "mahalanobis",
  robpca_k_max = 10,
  parallel = TRUE,
  n_threads = 0,
  verbose = FALSE
)
}
\arguments{
\item{data}{Numeric matrix (n x p) of data values}

\item{coords}{Numeric matrix (n x 2) of coordinates (e.g., longitude, latitude)}

\item{bandwidth}{Positive numeric value for spatial bandwidth}

\item{method}{Character string specifying the robust method. Options include:
\itemize{
  \item "standard" - Standard GWPCA
  \item "adaptive_huber" - Adaptive Huber M-estimator (default)
  \item "adaptive_mcd" - Adaptive Minimum Covariance Determinant
  \item "spatial_trim" - Spatial trimming method
}}

\item{use_correlation}{Logical, whether to use correlation matrix instead of covariance}

\item{k}{Integer, number of components to retain (default: all)}

\item{detect_outliers}{Logical, whether to detect spatial outliers first}

\item{outlier_threshold}{Numeric, threshold for outlier detection (default: 2.5)}

\item{trim_prop}{Numeric, trimming proportion for spatial_trim method (default: 0.1)}

\item{h_fraction}{Numeric, fraction parameter for adaptive methods (default: 0.75)}

\item{lof_k}{Integer, number of neighbors for LOF outlier detection (default: 10)}

\item{bacon_alpha}{Numeric, significance level for BACON method (default: 0.05)}

\item{depth_type}{Character, type of depth measure ("mahalanobis", "projection", "spatial")}

\item{robpca_k_max}{Integer, maximum number of components for ROBPCA (default: 10)}

\item{parallel}{Logical, whether to use parallel processing}

\item{n_threads}{Integer, number of threads to use (0 = auto)}

\item{verbose}{Logical, whether to show progress}
}
\value{
A list of class 'gwpca' containing:
  \item{eigenvalues}{Matrix (n x p) of eigenvalues at each location}
  \item{loadings}{3D array (n x p x k) of component loadings}
  \item{scores}{Matrix (n x k) of component scores}
  \item{var_explained}{Matrix (n x k) of variance explained proportions}
  \item{coords}{Input coordinate matrix}
  \item{bandwidth}{Used bandwidth value}
  \item{method}{Method used}
  \item{use_correlation}{Whether correlation was used}
  \item{n_components}{Number of components retained}
  \item{spatial_outliers}{Vector of outlier indicators (if detect_outliers = TRUE)}
}
\description{
Performs Geographically Weighted PCA with various robust methods
}
\examples{
\dontrun{
# Generate example data
n <- 500
p <- 5
coords <- matrix(runif(n * 2), ncol = 2)
data <- matrix(rnorm(n * p), ncol = p)

# Standard GWPCA
result <- gwpca(data, coords, bandwidth = 0.3)

# Robust GWPCA with outlier detection
result_robust <- gwpca(data, coords, bandwidth = 0.3,
                      method = "adaptive_huber",
                      detect_outliers = TRUE)

# Print summary
print(result_robust)
summary(result_robust)
}

}
